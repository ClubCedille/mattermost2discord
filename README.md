# mattermost2discord

[![](https://github.com/cguertin14/advent-of-code-2020/workflows/CI/badge.svg)](https://github.com/ClubCedille/mattermost2discord/actions)
[![Go Report Card](https://goreportcard.com/badge/github.com/ClubCedille/mattermost2discord)](https://goreportcard.com/report/github.com/ClubCedille/mattermost2discord)
[![Coverage Status](https://coveralls.io/repos/github.com/ClubCedille/mattermost2discord/badge.svg?branch=main)](https://coveralls.io/github.com/ClubCedille/mattermost2discord?branch=main)

REST API that forwards messages from Mattermost to Discord, using a callback.

## Depencencies

* [Go 1.15](https://golang.org/dl/)
* [Docker](https://docs.docker.com/get-docker/)
* [Docker-Compose](https://docs.docker.com/compose/install/)

## Development

### Running the API - using Docker

To run the API, you can use the following command:
```bash
$ make docker
...
```

The service will then run on the port 3000.

### Running the API - without Docker

You can also run the API without Docker, but make sure the `PORT` environment variable is set on your machine to something like `3000` or any other port available on your computer. You can run it with the following command:
```bash
$ make run
...
```

### Running the tests

To run the tests, simply execute this command:
```bash
$ make test
...
```
### Git hooks

To share the same versioned across the team, execute this command:
```bash
$ git config core.hooksPath .githooks
```

## Configuration 


![Mattermost2Discord](https://www.plantuml.com/plantuml/svg/XLJVRzCm47xtNt5QdoV4NX0LgfOjga1geLgAzW0yN9nhQZMsCzkX5CJ_phbDHf9rsuiTtNtVTp-TQn_GXKPNiCGGo6dhmrMglBIk4CBlbAdHeGOV3XNnwPICw9udeuU6ZAGbUOyb9PKgZIOJGF91RY3IGk6FI9op-rjRMGSfKPtj3ZTLGoAHmReRZatkgNEXDhHGXlh-VE10kIkTRKnnSawIz-bjEXTYnJKggMequJdnFcGaazgY93T6pQq9dr4JVD8roZ1sPUetmTjtOtERs37jjjfHD7neyEJvZt_Iedw4HyCncmHh-YN-2e7H35yziQG_tPFxhGgKQRiRLD8RVOGkbp1Pg78Ria1KZSi6kBYd7Dx0n_LwTH7nUyepSZyLp_KbdjPN1UzLP7IVBy7R7OpmelqSmqMdS_bjqdRdn-MidyyKaZsgu673hLXzoTRWuWhw88xzwF5ciUnfR9C7NlAI1mxx-0ROF80Dr3CoXHyATpbzODQTFM1rZdT7oBoM0haj3aB47QXXvQpaXwHCENIVBxMpJliZ_6xMF633DpPXouzGRPJ4eAnvLMLkdMOa1n_eDR5P-lI-1PTyJcVsEAOfTtkFZWjiATnGsvHR5keWkGtYceNuJ_8F "Mattermost2Discord")


### 1. Webhook set up

Set up an [outgoing webhook](https://docs.mattermost.com/developer/webhooks-outgoing.html) from mattermost with a specified channel that delivers the payload to your web service with the following option selected :

![Mattermost webhook Config](img/MattermostWebHook.png)

Keep the token generated by the creation of the webhook.

### 2. Set up Discord bot

Create your [discord bot](https://discordpy.readthedocs.io/en/stable/discord.html), invite it to your server and keep the token provided.

### 3. Set up environnement variables

Set all of the following env variables :
    
- DISCORD_TOKEN : Discord bot token
- MATTERMOST_TOKEN : Mattermost Webhook token
- DISCORD_CHANNEL : Discord Channel id which will foward messages
- TRIGGER_WORD_MATTERMOST : Trigger word to foward your message from mattermost to discord.
- Listening port

### 4. Hosting mm2disc on your web server & Docker Hub repo







